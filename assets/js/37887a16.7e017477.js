"use strict";(self.webpackChunkonekijs_website=self.webpackChunkonekijs_website||[]).push([[22804],{85162:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(67294),a=n.n(r),o=n(86010),i="tabItem_Ymn6";function l(e){var t=e.children,n=e.hidden,r=e.className;return a().createElement("div",{role:"tabpanel",className:(0,o.Z)(i,r),hidden:n},t)}},65488:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(87462),a=n(67294),o=n.n(a),i=n(86010),l=n(72389),s=n(67392),u=n(7094),p=n(12466),c="tabList__CuJ",d="tabItem_LNqP";function m(e){var t,n,l=e.lazy,m=e.block,h=e.defaultValue,g=e.values,k=e.groupId,b=e.className,f=o().Children.map(e.children,(function(e){if((0,a.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),v=null!=g?g:f.map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes}})),x=(0,s.l)(v,(function(e,t){return e.value===t.value}));if(x.length>0)throw new Error('Docusaurus error: Duplicate values "'+x.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var y=null===h?h:null!=(t=null!=h?h:null==(n=f.find((function(e){return e.props.default})))?void 0:n.props.value)?t:f[0].props.value;if(null!==y&&!v.some((function(e){return e.value===y})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+y+'" but none of its children has the corresponding value. Available values are: '+v.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var N=(0,u.U)(),w=N.tabGroupChoices,E=N.setTabGroupChoices,T=(0,a.useState)(y),C=T[0],I=T[1],Z=[],j=(0,p.o5)().blockElementScrollPositionUntilNextRender;if(null!=k){var _=w[k];null!=_&&_!==C&&v.some((function(e){return e.value===_}))&&I(_)}var A=function(e){var t=e.currentTarget,n=Z.indexOf(t),r=v[n].value;r!==C&&(j(t),I(r),null!=k&&E(k,String(r)))},P=function(e){var t,n=null;switch(e.key){case"ArrowRight":var r,a=Z.indexOf(e.currentTarget)+1;n=null!=(r=Z[a])?r:Z[0];break;case"ArrowLeft":var o,i=Z.indexOf(e.currentTarget)-1;n=null!=(o=Z[i])?o:Z[Z.length-1]}null==(t=n)||t.focus()};return o().createElement("div",{className:(0,i.Z)("tabs-container",c)},o().createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":m},b)},v.map((function(e){var t=e.value,n=e.label,a=e.attributes;return o().createElement("li",(0,r.Z)({role:"tab",tabIndex:C===t?0:-1,"aria-selected":C===t,key:t,ref:function(e){return Z.push(e)},onKeyDown:P,onFocus:A,onClick:A},a,{className:(0,i.Z)("tabs__item",d,null==a?void 0:a.className,{"tabs__item--active":C===t})}),null!=n?n:t)}))),l?(0,a.cloneElement)(f.filter((function(e){return e.props.value===C}))[0],{className:"margin-top--md"}):o().createElement("div",{className:"margin-top--md"},f.map((function(e,t){return(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==C})}))))}function h(e){var t=(0,l.Z)();return o().createElement(m,(0,r.Z)({key:String(t)},e))}},64094:function(e,t,n){var r=n(67294),a=n.n(r),o=n(65488);n(85162);t.Z=function(e){var t=e.children;return a().createElement(o.Z,{groupId:"application-types",defaultValue:"cra",values:[{label:"Vite App",value:"cra"},{label:"Nextjs App",value:"next"}]},t)}},20819:function(e,t,n){n.d(t,{b4:function(){return u}});var r=n(67294),a=n.n(r),o=n(64094),i=n(85162),l=n(95665),s=n.n(l),u=function(e){var t=e.path,n=e.craPath,r=e.nextPath,l=e.branch,u=void 0===l?"react18":l;return a().createElement(o.Z,null,a().createElement(i.Z,{value:"cra"},a().createElement(s(),{language:"tsx"},"https://github.com/oneki/onekijs/blob/"+u+"/getting-started/cra"+(n||t)+"\n")),a().createElement(i.Z,{value:"next"},a().createElement(s(),{language:"tsx"},"https://github.com/oneki/onekijs/blob/"+u+"/getting-started/next"+(r||t)+"\n")))}},32779:function(e,t,n){n.d(t,{YK:function(){return s},g0:function(){return u}});var r=n(67294),a=n.n(r),o=n(64094),i=n(85162),l=function(e){var t=e.name,n=e.height,r=void 0===n?500:n,o=e.modules,i=(e.branch,e.type,e.view,"https://oneki-gs-vite-"+t.split("-")[0]+".surge.sh/");o&&("&module=",o.forEach((function(e,t){t>0&&",",e})));var l="onekijs-"+t.split("/").join("-");return a().createElement("iframe",{src:i,style:{width:"100%",height:r+"px",border:"10px solid #EEE",bordeRadius:"4px",overflow:"hidden"},title:l,allow:"accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking",sandbox:"allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"})},s=function(e){var t=e.name;return a().createElement("div",{style:{textAlign:"right"}},a().createElement("a",{href:"https://codesandbox.io/s/github/oneki/onekijs/tree/master/examples/"+t,target:"_blank",style:{display:"inline-flex",alignItems:"center",height:"32px",padding:"0px 12px",fontSize:"13px",fontWeight:500,color:"rgb(255, 255, 255)",backgroundColor:"#2196f3",borderRadius:"4px",textDecoration:"none",cursor:"pointer",marginBottom:"2px"}},"Open in Codesandbox"))},u=function(e){var t=e.name,n=e.modules,r=e.craName,s=e.craModules,u=e.nextName,p=e.nextModules,c=e.height,d=void 0===c?600:c,m=e.branch,h=void 0===m?"master":m;return a().createElement(o.Z,null,a().createElement(i.Z,{value:"cra"},a().createElement(l,{name:r||t,type:"getting-started/cra",view:"preview",branch:h,height:d,modules:s||n})),a().createElement(i.Z,{value:"next"},a().createElement(l,{name:u||t,type:"getting-started/next",view:"preview",branch:h,height:d,modules:p||n})))};t.ZP=l},63139:function(e,t,n){n.r(t),n.d(t,{assets:function(){return m},contentTitle:function(){return c},default:function(){return k},frontMatter:function(){return p},metadata:function(){return d},toc:function(){return h}});var r=n(87462),a=n(63366),o=(n(67294),n(3905)),i=(n(44996),n(64094)),l=n(85162),s=n(32779),u=(n(20819),["components"]),p={id:"error-handling",title:"Handling errors",sidebar_label:"Handling errors"},c=void 0,d={unversionedId:"getting-started/error-handling",id:"getting-started/error-handling",title:"Handling errors",description:"",source:"@site/docs/getting-started/008_error-handling.md",sourceDirName:"getting-started",slug:"/getting-started/error-handling",permalink:"/docs/getting-started/error-handling",draft:!1,editUrl:"https://github.com/oneki/oneki.github.io/edit/source/docs/getting-started/008_error-handling.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{id:"error-handling",title:"Handling errors",sidebar_label:"Handling errors"},sidebar:"someSidebar",previous:{title:"Centralizing notifications",permalink:"/docs/getting-started/notification"},next:{title:"Internationalization",permalink:"/docs/getting-started/i18n"}},m={},h=[{value:"Final result",id:"final-result",level:2},{value:"Error boundaries",id:"error-boundaries",level:2},{value:"Error handling",id:"error-handling",level:2},{value:"Error handling",id:"error-handling-1",level:2},{value:"Next step",id:"next-step",level:2}],g={toc:h};function k(e){var t=e.components,n=(0,a.Z)(e,u);return(0,o.kt)("wrapper",(0,r.Z)({},g,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Two types of errors can occur:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Those thrown when rendering a component. To handle this type of error, React recommends implementing ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("a",{parentName:"strong",href:"https://reactjs.org/docs/error-boundaries.html"},"Error Boundaries")),"."),(0,o.kt)("li",{parentName:"ul"},"Standard errors launched by your javascript code (try/catch) or returned by the server.")),(0,o.kt)("p",null,"This step consists in handling this kind of errors."),(0,o.kt)("h2",{id:"final-result"},"Final result"),(0,o.kt)("p",null,"The result of this step is as follows:"),(0,o.kt)("admonition",{title:"New in this step",type:"info"},(0,o.kt)("p",{parentName:"admonition"},'The third product is now named "Invalid product". Clicking on this product simulates an error when the page is rendered.',(0,o.kt)("br",null),'\nThe "Buy" button now calls an API that returns an HTTP 400 error indicating that the product is not available at the moment')),(0,o.kt)(s.g0,{name:"step07-error-handling",craModules:["/src/index.tsx","/src/pages/products/index.tsx"],nextModules:["/src/pages/index.tsx","/src/pages/_app.tsx"],mdxType:"GettingStartedSandbox"}),(0,o.kt)("h2",{id:"error-boundaries"},"Error boundaries"),(0,o.kt)("p",null,"You can pass a component to ","<","App /",">"," (via the prop ErrorBoundaryComponent). This component will be displayed when an error occurs during the rendering."),(0,o.kt)("p",null,"First, let's create this component"),(0,o.kt)(i.Z,{mdxType:"Tabs"},(0,o.kt)(l.Z,{value:"cra",mdxType:"TabItem"},"You can pass a component to ",(0,o.kt)("code",null,"<App />")," (via the prop ",(0,o.kt)("code",null,"ErrorBoundaryComponent"),"). This component will be displayed when an error occurs during the rendering.",(0,o.kt)("p",null),"First, let's create this component:",(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"reference",reference:!0},"https://github.com/oneki/onekijs/blob/master/getting-started/cra/step07-error-handling/src/modules/core/components/ErrorBoundary.tsx\n")),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"This component has access to the application context. It means you can use any Oneki hooks in this component (e.g: useGlobalState)")),(0,o.kt)("p",null,"Update the entry point to pass this component to ",(0,o.kt)("inlineCode",{parentName:"p"},"<App />")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"reference",reference:!0},"https://github.com/oneki/onekijs/blob/master/getting-started/cra/step07-error-handling/src/index.tsx\n")),(0,o.kt)("h2",{id:"error-handling"},"Error handling"),(0,o.kt)("p",null,"When an error occurs (outside the rendering phase), we recommend displaying it via the ",(0,o.kt)("inlineCode",{parentName:"p"},"<NotificationCenter />"),".",(0,o.kt)("br",null),"\nTo simulate an error from the server, a new API is exposed by the server that returns an HTTP 400 response with the following body:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "message": "The product ${req.body.name} is not available at this moment"\n}\n')),(0,o.kt)("p",null),"Let's update the product details page to:",(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},'simulate an error during the rendering phase when the product name is "Phone Invalid"'),(0,o.kt)("li",{parentName:"ul"},"display the error from the server via the NotificationCenter.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"reference",reference:!0},"https://github.com/oneki/onekijs/blob/master/getting-started/cra/step07-error-handling/src/pages/products/%5BproductId%5D/index.tsx\n"))),(0,o.kt)(l.Z,{value:"next",mdxType:"TabItem"},(0,o.kt)("p",null,"You can pass a component to ",(0,o.kt)("code",null,"<","NextApp /",">")," (via the prop ",(0,o.kt)("code",null,"ErrorBoundaryComponent"),"). This component will be displayed when an error occurs during the rendering."),(0,o.kt)("p",null),"First, let's create this component:",(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"reference",reference:!0},"https://github.com/oneki/onekijs/blob/master/getting-started/next/step07-error-handling/src/modules/core/components/ErrorBoundary.tsx\n")),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"This component has access to the application context. It means you can use any Oneki hooks in this component (e.g: useGlobalState)")),(0,o.kt)("p",null,"Update the entry point to pass this component to ",(0,o.kt)("inlineCode",{parentName:"p"},"<NextApp />")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"reference",reference:!0},"https://github.com/oneki/onekijs/blob/master/getting-started/next/step07-error-handling/src/pages/_app.tsx\n")),(0,o.kt)("h2",{id:"error-handling-1"},"Error handling"),(0,o.kt)("p",null,"When an error occurs (outside the rendering phase), we recommend displaying it via the ",(0,o.kt)("inlineCode",{parentName:"p"},"<NotificationCenter />"),".",(0,o.kt)("br",null),"\nTo simulate an error from the server, a new API is exposed by the server that returns an HTTP 400 response with the following body:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "message": "The product ${req.body.name} is not available at this moment"\n}\n')),(0,o.kt)("p",null),"Let's update the product details page to:",(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},'simulate an error during the rendering phase when the product name is "Phone Invalid"'),(0,o.kt)("li",{parentName:"ul"},"display the error from the server via the NotificationCenter.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"reference",reference:!0},"https://github.com/oneki/onekijs/blob/master/getting-started/next/step07-error-handling/src/pages/products/%5BproductId%5D/index.tsx\n")))),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"When using an ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"onekijs"))," hook, if you don't specify a callback to handle errors, it will automatically send the following notification"),(0,o.kt)("pre",{parentName:"admonition"},(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"{\n  topic: 'error',\n  payload: {\n    message: ${error.message}\n  }\n  ...\n}\n")),(0,o.kt)("p",{parentName:"admonition"},"Therefore, the onError callback can be omitted")),(0,o.kt)("h2",{id:"next-step"},"Next step"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"i18n"},"In the next step")),", we adapt the application to support different languages (internationalization and localization)."))}k.isMDXComponent=!0}}]);