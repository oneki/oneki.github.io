"use strict";(self.webpackChunkoneki_js=self.webpackChunkoneki_js||[]).push([[42],{3905:function(t,e,n){n.d(e,{Zo:function(){return d},kt:function(){return f}});var r=n(7294),a=n.n(r);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e){if(null==t)return{};var n,r,a=function(t,e){if(null==t)return{};var n,r,a={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(a[n]=t[n]);return a}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}var s=a().createContext({}),c=function(t){var e=a().useContext(s),n=e;return t&&(n="function"==typeof t?t(e):l(l({},e),t)),n},d=function(t){var e=c(t.components);return a().createElement(s.Provider,{value:e},t.children)},p={inlineCode:"code",wrapper:function(t){var e=t.children;return a().createElement(a().Fragment,{},e)}},m=a().forwardRef((function(t,e){var n=t.components,r=t.mdxType,o=t.originalType,i=t.parentName,s=u(t,["components","mdxType","originalType","parentName"]),d=c(n),m=r,f=d["".concat(i,".").concat(m)]||d[m]||p[m]||o;return n?a().createElement(f,l(l({ref:e},s),{},{components:n})):a().createElement(f,l({ref:e},s))}));function f(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var u in e)hasOwnProperty.call(e,u)&&(l[u]=e[u]);l.originalType=t,l.mdxType="string"==typeof t?t:r,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return a().createElement.apply(null,i)}return a().createElement.apply(null,n)}m.displayName="MDXCreateElement"},3919:function(t,e,n){function r(t){return!0===/^(\w*:|\/\/)/.test(t)}function a(t){return void 0!==t&&!r(t)}n.d(e,{b:function(){return r},Z:function(){return a}})},4996:function(t,e,n){n.d(e,{C:function(){return o},Z:function(){return i}});var r=n(2263),a=n(3919);function o(){var t=(0,r.Z)().siteConfig,e=(t=void 0===t?{}:t).baseUrl,n=void 0===e?"/":e,o=t.url;return{withBaseUrl:function(t,e){return function(t,e,n,r){var o=void 0===r?{}:r,i=o.forcePrependBaseUrl,l=void 0!==i&&i,u=o.absolute,s=void 0!==u&&u;if(!n)return n;if(n.startsWith("#"))return n;if((0,a.b)(n))return n;if(l)return e+n;var c=n.startsWith(e)?n:e+n.replace(/^\//,"");return s?t+c:c}(o,n,t,e)}}}function i(t,e){return void 0===e&&(e={}),(0,o().withBaseUrl)(t,e)}},8215:function(t,e,n){var r=n(7294),a=n.n(r);e.Z=function(t){var e=t.children,n=t.hidden,r=t.className;return a().createElement("div",{role:"tabpanel",hidden:n,className:r},e)}},5064:function(t,e,n){n.d(e,{Z:function(){return p}});var r=n(7294),a=n.n(r),o=n(9443);var i=function(){var t=(0,r.useContext)(o.Z);if(null==t)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return t},l=n(6010),u="tabItem_1uMI",s="tabItemActive_2DSg";var c=37,d=39;var p=function(t){var e=t.lazy,n=t.block,o=t.defaultValue,p=t.values,m=t.groupId,f=t.className,g=i(),k=g.tabGroupChoices,h=g.setTabGroupChoices,b=(0,r.useState)(o),y=b[0],v=b[1],N=r.Children.toArray(t.children),w=[];if(null!=m){var x=k[m];null!=x&&x!==y&&p.some((function(t){return t.value===x}))&&v(x)}var O=function(t){var e=t.currentTarget,n=w.indexOf(e),r=p[n].value;v(r),null!=m&&(h(m,r),setTimeout((function(){var t,n,r,a,o,i,l,u;(t=e.getBoundingClientRect(),n=t.top,r=t.left,a=t.bottom,o=t.right,i=window,l=i.innerHeight,u=i.innerWidth,n>=0&&o<=u&&a<=l&&r>=0)||(e.scrollIntoView({block:"center",behavior:"smooth"}),e.classList.add(s),setTimeout((function(){return e.classList.remove(s)}),2e3))}),150))},j=function(t){var e,n;switch(t.keyCode){case d:var r=w.indexOf(t.target)+1;n=w[r]||w[0];break;case c:var a=w.indexOf(t.target)-1;n=w[a]||w[w.length-1]}null==(e=n)||e.focus()};return a().createElement("div",{className:"tabs-container"},a().createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":n},f)},p.map((function(t){var e=t.value,n=t.label;return a().createElement("li",{role:"tab",tabIndex:y===e?0:-1,"aria-selected":y===e,className:(0,l.Z)("tabs__item",u,{"tabs__item--active":y===e}),key:e,ref:function(t){return w.push(t)},onKeyDown:j,onFocus:O,onClick:O},n)}))),e?(0,r.cloneElement)(N.filter((function(t){return t.props.value===y}))[0],{className:"margin-vert--md"}):a().createElement("div",{className:"margin-vert--md"},N.map((function(t,e){return(0,r.cloneElement)(t,{key:e,hidden:t.props.value!==y})}))))}},9443:function(t,e,n){var r=n(7294),a=(0,r.createContext)(void 0);e.Z=a},5203:function(t,e,n){var r=n(3117),a=n(7294),o=n.n(a),i=n(2779);e.Z=function(t){return o().createElement(i.Z,(0,r.Z)({type:"next"},t))}},2779:function(t,e,n){var r=n(7294),a=n.n(r);e.Z=function(t){var e=t.name,n=t.height,r=void 0===n?500:n,o=t.modules,i=t.branch,l=void 0===i?"master":i,u=t.type,s=void 0===u?"example":u,c=t.view,d="https://codesandbox.io/embed/github/oneki/onekijs/tree/"+l+"/"+s+"/"+e+"?codemirror=1&fontsize=14&theme=dark&view="+(void 0===c?"editor":c);o&&(d+="&module=",o.forEach((function(t,e){e>0&&(d+=","),d+=t})));var p="onekijs-"+e.split("/").join("-");return a().createElement("iframe",{src:d,style:{width:"100%",height:r+"px",border:0,bordeRadius:"4px",overflow:"hidden"},title:p,allow:"geolocation; microphone; camera; midi; accelerometer; gyroscope; payment; encrypted-media; usb",sandbox:"allow-modals allow-forms allow-popups allow-scripts allow-same-origin"})}},8471:function(t,e,n){n.r(e),n.d(e,{frontMatter:function(){return u},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return d},default:function(){return m}});var r=n(3117),a=n(102),o=(n(7294),n(3905)),i=(n(4996),n(5064),n(8215),n(5203)),l=["components"],u={id:"form-based",title:"Form based",sidebar_label:"Form based"},s=void 0,c={unversionedId:"framework/auth/authentication-type/form-based",id:"framework/auth/authentication-type/form-based",isDocsHomePage:!1,title:"Form based",description:"Form based authentication means that the login page presents a form, so the user can specifiy his username and password.",source:"@site/docs/framework/auth/authentication-type/010_form-based.md",sourceDirName:"framework/auth/authentication-type",slug:"/framework/auth/authentication-type/form-based",permalink:"/docs/framework/auth/authentication-type/form-based",editUrl:"https://github.com/oneki/oneki.github.io/edit/source/docs/framework/auth/authentication-type/010_form-based.md",version:"current",sidebarPosition:10,frontMatter:{id:"form-based",title:"Form based",sidebar_label:"Form based"},sidebar:"someSidebar",previous:{title:"Introduction",permalink:"/docs/framework/auth/authentication-type/introduction"},next:{title:"OIDC (server side)",permalink:"/docs/framework/auth/authentication-type/oidc-server"}},d=[{value:"Architecture",id:"architecture",children:[]},{value:"Configuration",id:"configuration",children:[{value:"Mandatory attributes",id:"mandatory-attributes",children:[]}]},{value:"Example",id:"example",children:[]}],p={toc:d};function m(t){var e=t.components,n=(0,a.Z)(t,l);return(0,o.kt)("wrapper",(0,r.Z)({},p,n,{components:e,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Form based authentication")," means that the login page presents a form, so the user can specifiy his username and password."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Oneki.js")," lets you build the form as you wish, but provide you a function to:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"submit the username / password to the backend server"),(0,o.kt)("li",{parentName:"ul"},"handle the response returned by the backend server")),(0,o.kt)("h2",{id:"architecture"},"Architecture"),(0,o.kt)("p",null,"The following scenario is the standard flow when a non logged-in user wants to display a page reserved only for logged-in user. This means that this page is secured thanks to the ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("a",{parentName:"strong",href:"../secure-page"},"secure HOC")),(0,o.kt)("br",null),"\nThis flow can be customized via settings.js"),(0,o.kt)("img",{src:"https://www.plantuml.com/plantuml/png/VLF1Rjim3BtxAxYScaFYkmz3jwBeSGFQVG0jomuHMJ8eAcd_VfJT97RcpWU1eidt-4ZgCGgofDuLtyWRbngRsC51P8XLMTQSV6WP_P7s7SaXrNiAfQO8cHAZ8Mg2sGqEVOROnIFvFMKmD18O_aJBHHtUOVDZ6E3X9uUpUhQR0lGRb9SC3PeBcv9j52OZjja0HhXTLs9TwCYFOQDLMD-0iioOQZH7zQuouK0b9ZcC0Ddu8kPy2DZJ63MPLvui2tRVPqLMuF547OfLCDLE9pMN8cwNd3eMNgcp8RP6nX8QkvuvGvpqPjTeBP2mWMX5o7TnDIBYoK9WqWiwu90Kxs7Mz-qoAukieA6eq_s0Dd1_N-HKpAKPdoolgUv9mAWowuNGnMAb_YjBxdy5lt-zla5I88-zBGUCyHpuJlfrKjcufPxGKPF_BndPIcAV6m8cX2EfL6eX9cDiZDi2dKmuBP8Rc_o5xcVcm4-X7u9NyCAwE5LoWMgJcoVFD-8oMv00vTr0_-dYGkfTy79pfbsiuENvJUMPn2GVJy6BVP-sQ8RpkROJHkx72jnIxe2T_UykwXCeYaSzzP7_1G00",alt:null}),(0,o.kt)("h2",{id:"configuration"},"Configuration"),(0,o.kt)("p",null,"The configuration parameters are the following:"),(0,o.kt)("h3",{id:"mandatory-attributes"},"Mandatory attributes"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Key"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"type")),(0,o.kt)("td",{parentName:"tr",align:null},"string"),(0,o.kt)("td",{parentName:"tr",align:null},'must be "',(0,o.kt)("strong",{parentName:"td"},"form"),'"')),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"loginEndpoint")),(0,o.kt)("td",{parentName:"tr",align:null},"string ","|",(0,o.kt)("br",null),"function(context)"),(0,o.kt)("td",{parentName:"tr",align:null},"Can be",(0,o.kt)("ul",null,(0,o.kt)("li",null,"A relative or absolute URL"),(0,o.kt)("li",null,"A function returning the URL")))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"logoutEndpoint")),(0,o.kt)("td",{parentName:"tr",align:null},"string ","|",(0,o.kt)("br",null),"function(context)"),(0,o.kt)("td",{parentName:"tr",align:null},"Can be",(0,o.kt)("ul",null,(0,o.kt)("li",null,"A relative or absolute URL"),(0,o.kt)("li",null,"A function returning the URL")))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"userinfoEndpoint")),(0,o.kt)("td",{parentName:"tr",align:null},"string ","|",(0,o.kt)("br",null)," function (context)"),(0,o.kt)("td",{parentName:"tr",align:null},"Can be:",(0,o.kt)("ul",null,(0,o.kt)("li",null,"A relative or absolute URL"),(0,o.kt)("li",null,"A function that returns an object representing the userInfo. ",(0,o.kt)("br",null),"For example a object like this: {email: '",(0,o.kt)("a",{parentName:"td",href:"mailto:foo@example.com"},"foo@example.com"),"', roles: ","['ADMIN']","}}")))))),(0,o.kt)("h4",{id:"optional-attributes"},"Optional attributes"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Key"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Default"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"loginMethod")),(0,o.kt)("td",{parentName:"tr",align:null},"string"),(0,o.kt)("td",{parentName:"tr",align:null},"POST"),(0,o.kt)("td",{parentName:"tr",align:null},"if ",(0,o.kt)("strong",{parentName:"td"},"loginEndpoint")," is an URL, the method used to send username and password to the server")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"loginContentType")),(0,o.kt)("td",{parentName:"tr",align:null},"string"),(0,o.kt)("td",{parentName:"tr",align:null},"application/json"),(0,o.kt)("td",{parentName:"tr",align:null},"can be",(0,o.kt)("ul",null,(0,o.kt)("li",null,"application/x-www-form-urlencoded"),(0,o.kt)("li",null,"application/json")))),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"usernameKey")),(0,o.kt)("td",{parentName:"tr",align:null},"string"),(0,o.kt)("td",{parentName:"tr",align:null},"username"),(0,o.kt)("td",{parentName:"tr",align:null},"the field expected by the server for the username")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"passwordKey")),(0,o.kt)("td",{parentName:"tr",align:null},"string"),(0,o.kt)("td",{parentName:"tr",align:null},"password"),(0,o.kt)("td",{parentName:"tr",align:null},"the field expected by the server for the password")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"rememberMeKey")),(0,o.kt)("td",{parentName:"tr",align:null},"string"),(0,o.kt)("td",{parentName:"tr",align:null},"rememberMe"),(0,o.kt)("td",{parentName:"tr",align:null},"the field expected by the server for the rememberMe feature")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"logoutMethod")),(0,o.kt)("td",{parentName:"tr",align:null},"string"),(0,o.kt)("td",{parentName:"tr",align:null},"GET"),(0,o.kt)("td",{parentName:"tr",align:null},"if ",(0,o.kt)("strong",{parentName:"td"},"logoutEndpoint")," is an URL, the method used to call the logout URL")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"callback")),(0,o.kt)("td",{parentName:"tr",align:null},"function(response, context): ","[token,securityContext]"),(0,o.kt)("td",{parentName:"tr",align:null},"null"),(0,o.kt)("td",{parentName:"tr",align:null},"a callback function to parse the result of the authentication.",(0,o.kt)("br",null),"The fonction returns optionally a token and/or a securityContext  (if not set, it's assumed that the session is done via a cookie and the security context is retrieved via the ",(0,o.kt)("strong",{parentName:"td"},"userinfoEndpoint")," defined above)")))),(0,o.kt)("h4",{id:"configuration-example"},"Configuration example"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"export default {\n  idp: {\n    default: {\n      // MANDATORY parameters\n      type: 'form',\n      loginEndpoint: '/api/login',\n      logoutEndpoint: '/api/logout',\n      userinfoEndpoint: '/api/whoami',\n\n      // OPTIONAL parameters\n      loginMethod: 'POST',\n      loginContentType: 'application/json',\n      usernameKey: 'username',\n      passwordKey: 'password',\n      rememberMeKey: 'rememberMe',\n      logoutMethod: 'GET',\n      callback: (result, context) => [null, result]  \n    }\n  }\n}\n")),(0,o.kt)("h2",{id:"example"},"Example"),(0,o.kt)(i.Z,{name:"auth/form",height:"600",modules:["src/settings.js","/src/pages/login.js","/src/pages/logout.js","/src/pages/profile.js","/src/pages/admin.js"],mdxType:"NextSandbox"}))}m.isMDXComponent=!0},6010:function(t,e,n){function r(t){var e,n,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t)if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=r(t[e]))&&(a&&(a+=" "),a+=n);else for(e in t)t[e]&&(a&&(a+=" "),a+=e);return a}function a(){for(var t,e,n=0,a="";n<arguments.length;)(t=arguments[n++])&&(e=r(t))&&(a&&(a+=" "),a+=e);return a}n.d(e,{Z:function(){return a}})}}]);