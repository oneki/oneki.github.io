---
id: app
title: Application
sidebar_label: Application
---

import Tabs from '@site/src/components/DocTabs';
import TabItem from "@theme/TabItem";
import Sandbox from '@site/src/components/Sandbox';

**Oneki.js** provides a component to wrap the complete Application. This component bootstraps the framework and is generally the outermost component of an application

:::note Tabs
The `Application component` is not the same for apps built on top of **Create React App** or **Next.js**<br/>
Select the correct tab to display the documentation for what you use.
:::

<Tabs>
  <TabItem value="next">

```jsx
<NextApp
  settings={settings}
  store={store}
  initialState={initialState}
  services={[service]}
  LoadingComponent={LoadingComponent}
  Component={Component}
  pageProps={pageProps}
/>
```

**_NextApp_** is the main component that bootstraps the **_Oneki.js framework_** on top of **_Next.js_**<br/>
This component is generally the outermost component of an application (defined in the file \_app.js) and is responsible of:

- creating a Redux store:
  - If props.**store** is present, **_App_** doesn't create a Redux store but uses this one
  - Otherwise, **_App_** creates a Redux store with props.**initialState** as initialState
- creating and injecting the **services** in the Redux store
- creating a context that contains three elements:
  - **router**: accessible via useOnekiRouter()
  - **settings**: accessible via useSettings()
  - **redux store**: accessible via useStore()

### Parameters

*Mandatory parameters are in bold*

| Parameter | Type | Description |
| --------- | ---- | ----------- |
| settings | object | Settings is a object generally defined in the file settings.js<br/>Data defined in settings.js are available across the application and contains configuration data.<br/><br/>**Defaults**: {} |
| store | ReduxStore | A standard Redux store, but created via the helper createReduxStore from onekijs<br/>The store must be created via this helper so onekijs can control it<br/><br/>**Defaults**: A store created by `NextApp` (recommended) |
| initialState | any | The initial state is used by `NextApp` when it creates a Redux store<br/>This initalState becomes the initialState of the Redux store.<br/><br/>**Defaults**: null |
| services | [Service] | An array of Services that will be available globally across the application.<br/>Check **[this documentation](../framework/service/introduction)** for more info. <br/><br/>**Defaults**: [] |
| LoadingComponent | React Component | A component expected by <Suspense\> (use to display a loading indicator)<br/><br/>**Defaults**: `DefaultLoadingComponent` that displays "Loading..."  |
| Component | React Component | The Page component injected by `Next.js`
| pageProps | any | The Page props injected by `Next.js`

#### Custom redux store
A custom Redux store is created by calling the helper createReduxStore from Oneki.js<br/>
The helper expects an initial state and an array of Redux middlewares.

```javascript
const store = createReduxStore((initialState = {}), (middlewares = []));
```

## Examples

#### Minimal example

<Sandbox 
  name="next-app-basic" 
  height="500" 
  modules={['/src/pages/_app.js','/src/pages/index.js','/src/pages/users.js','/package.json']} 
/>

<br/><br/>

#### Example with custom settings

<Sandbox 
  name="next-auth-oidc" 
  height="450" 
  modules={['/src/pages/_app.js','/src/settings.js', '/src/pages/index.js']} 
/>

  </TabItem>
  <TabItem value="cra">

```jsx
<App
  settings={settings}
  store={store}
  initialState={initialState}
  services={[service]}
  history={history}
  LoadingComponent={LoadingComponent}
/>
```

**_App_** is the main component that bootstraps the **_Oneki.js framework_** on top of **_Create React App_**<br/>
This component is generally the outermost component of an application and is responsible of:

- creating a Redux store:
  - If props.**store** is present, **_App_** doesn't create a Redux store but uses this one
  - Otherwise, **_App_** creates a Redux store with props.**initialState** as initialState
- creating a React Router. By default, it creates a **BrowserRouter**, but this can be configured via the file **settings.js**
- creating and injecting the **services** in the Redux store
- creating a context that contains three elements:
  - **router**: accessible via useRouter()
  - **settings**: accessible via useSettings()
  - **redux store**: accessible via useStore()

### Parameters
*Mandatory parameters are in bold*

| Parameter | Type | Description |
| --------- | ---- | ----------- |
| settings | object | Settings is a object generally defined in the file settings.js<br/>Data defined in settings.js are available across the application and contains configuration data.<br/><br/>**Defaults**: {} |
| store | ReduxStore | A standard Redux store, but created via the helper createReduxStore from onekijs<br/>The store must be created via this helper so onekijs can control it<br/><br/>**Defaults**: A store created by `App` (recommended) |
| initialState | any | The initial state is used by `App` when it creates a Redux store<br/>This initalState becomes the initialState of the Redux store.<br/><br/>**Defaults**: null |
| services | [Service] | An array of Services that will be available globally across the application.<br/>Check **[this documentation](../framework/service/introduction)** for more info. <br/><br/>**Defaults**: [] |
| history | History | An object expected by React Router. Must be one of the history it supports<br/>If history is null, `App` checks if an history is defined in the Settings<br/><br/>**Defaults**: BrowserHistory
| LoadingComponent | React Component | A component expected by <Suspense\> (use to display a loading indicator)<br/><br/>**Defaults**: `DefaultLoadingComponent` that displays "Loading..."  |

#### Custom redux store
A custom Redux store is created by calling the helper createReduxStore from Oneki.js<br/>
The helper expects an initial state and an array of Redux middlewares.

```javascript
const store = createReduxStore((initialState = {}), (middlewares = []));
```

## Examples

### Minimal example

<Sandbox 
  name="cra-app-basic" 
  height="600" 
  modules={['/src/index.js']} 
/>

### App with settings, store, services and fallback
This example shows how to create the props expected by `App`
Generally, only the prop settings is passed to `App` and the other props (store, services, ...) are initialized by the `App` itself.

This example initialized an `App` by passing these props:
- **Settings**: the settings are defined in the file `src/settings.js`
- **A redux store**: Normally the redux store should not be initialized manually, but this example shows how it's possible to inject our own store
- **A global service**: A global service is instantied only once and accessible anywhere in the application. The role of a service is to manipulate the Redux store. Check **[this documentation](../framework/service/introduction)** for more info.

<CraSandbox 
  name="application/settings-store-services" 
  height="600" 
  modules={['/src/index.js', '/src/settings.js']} 
/>

  </TabItem>
</Tabs>